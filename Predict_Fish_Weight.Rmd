---
title: "Weight of Fish"
author: "Evelyn Chairez / Summer 2024"
date: "`r Sys.Date()`"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5

 
    
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
require(car)
require(leaps)
```

# Predicting Fish Weight
```{r}
fish <- read.csv(file = "Fish.csv")
```

```{r eval=TRUE}
 
fish <- fish %>%
mutate(across(where(is.character), as.factor))
levels(fish$Species)
Bream <- filter(fish, Species == "Bream")
Bream <- select(Bream, -Species) 
Parkki <- filter(fish, Species == "Parkki")
Parkki <- select(Parkki, -Species) 
Perch <- filter(fish, Species == "Perch")
Perch <- select(Perch, -Species) 
Pike <- filter(fish, Species == "Pike")
Pike <- select(Pike, -Species) 
Roach <- filter(fish, Species == "Roach")
Roach <- select(Roach, -Species) 
Smelt <- filter(fish, Species == "Smelt")
Smelt <- select(Smelt, -Species) 
Whitefish <- filter(fish, Species == "Whitefish")
Whitefish <- select(Whitefish, -Species) 
```

# For each of the three species of fish listed below, determine the best regression model and also the best 2 element regression model. Use the BestSubset Regression helper file.


## Perch

```{r}
fullup <- lm(Weight~ .,data=Perch)
summary.lm(fullup)
```

### Best Models

The data for the Adjusted Squared has a best model for Length1. We can determine this summary has a p-value of 2.2e-16.

### Best Two regressor model

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Perch,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottom",main="Adjusted R^2")
```
  
Using the above chart, we can see that the best regression models are Height and Weight. This model is the best for the Perch data, as well as for the two element model.

## Pike

```{r}
fullup <- lm(Weight~ .,data=Pike)
summary.lm(fullup)
```

### Best Models
  
This chart's best model is the L1-L2L-L3, Height and Weight measurement. This has an estimated Asjusted R Sqaure is 0.9794.

### Best Two regressor model

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Pike,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topleft",main="Adjusted R^2")
```
  
The best two element model on the given chart is L1-L3, with an Adjusted R Squared number of 0.0965. 

## Roach

```{r}
fullup <- lm(Weight~ .,data=Roach)
summary.lm(fullup)
```
```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Roach,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottomleft",main="Adjusted R^2")
```
  
### Best Models
  
This chart provides that the best overall model is L3 and Width.
  
### Best Two regressor model

The best two regressor model is also L3 and Width. The Adjusted R squared is 0.821.

## Final Summary Statements
  
To find out the comparative data between, Perch, Pike, and Roach, we used the leap program to find out the best regressor models.  
Using leaps we can display all the appropriate data, such as the Adjusted R Squared number to find out which model when compared to the variable weight had an impact on the outcome.  
In this case we took note of the Adjusted R Squared number and the best two regressor models in each fish species.  
